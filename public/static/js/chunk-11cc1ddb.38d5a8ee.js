(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-11cc1ddb"],{"0e88":function(t,e,n){"use strict";n("d00d")},"1e78":function(t,e,n){"use strict";(function(t){n("99af"),n("a434"),n("d3b7"),n("ac1f"),n("25f0"),n("1276");var o=n("5124");e.a={name:"LogView",props:{logName:{type:String,default:""}},data:function(){return{loading:!1,hasMore:!1,logContent:[],tableY:230,itemHeight:25,startByte:0,endByte:10240}},created:function(){this.loadingLog()},methods:{loadingLog:function(){var e=this;this.loading=!0,Object(o.b)({logName:this.logName,startByte:this.startByte,endByte:this.endByte}).then((function(n){e.hasMore=n.hasMore;var o=t.from(n.content,"base64").toString().split("\r\n");""===o[o.length-1]?(o.splice(o.length-1,1),e.hasMore||(o[0]=e.logContent.splice(e.logContent.length-1,1)+o[0])):o[0]=e.logContent.splice(e.logContent.length-1,1)+o[0],e.logContent=e.logContent.concat(o),e.hasMore&&(e.startByte=n.startByte,e.endByte=n.endByte)})).catch((function(){})).finally((function(){e.loading=!1}))},close:function(){this.$emit("closeDialog")},onResize:function(){this.tableY=window.innerHeight-180},onScroll:function(t){this.hasMore&&!this.loading&&t.target.scrollTop+t.target.offsetHeight>t.target.scrollHeight-100&&this.loadingLog()}}}}).call(this,n("b639").Buffer)},"21a6":function(t,e,n){(function(n){var o,i,a;i=[],void 0===(a="function"==typeof(o=function(){"use strict";function e(t,e,n){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){s(o.response,e,n)},o.onerror=function(){},o.send()}function o(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function i(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,s=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype?function(t,n,s){var c=a.URL||a.webkitURL,r=document.createElement("a");n=n||t.name||"download",r.download=n,r.rel="noopener","string"==typeof t?(r.href=t,r.origin===location.origin?i(r):o(r.href)?e(t,n,s):i(r,r.target="_blank")):(r.href=c.createObjectURL(t),setTimeout((function(){c.revokeObjectURL(r.href)}),4e4),setTimeout((function(){i(r)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,n,a){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,a),n);else if(o(t))e(t,n,a);else{var s=document.createElement("a");s.href=t,s.target="_blank",setTimeout((function(){i(s)}))}}:function(t,n,o,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,o);var s="application/octet-stream"===t.type,c=/constructor/i.test(a.HTMLElement)||a.safari,r=/CriOS\/[\d]+/.test(navigator.userAgent);if((r||s&&c)&&"object"==typeof FileReader){var l=new FileReader;l.onloadend=function(){var t=l.result;t=r?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=t:location=t,i=null},l.readAsDataURL(t)}else{var d=a.URL||a.webkitURL,u=d.createObjectURL(t);i?i.location=u:location.href=u,i=null,setTimeout((function(){d.revokeObjectURL(u)}),4e4)}});a.saveAs=s.saveAs=s,t.exports=s})?o.apply(e,i):o)||(t.exports=a)}).call(this,n("c8ba"))},"3b6a":function(t,e,n){"use strict";n.r(e),n("4de4"),n("c975"),n("d3b7");var o=n("5530"),i=n("5124"),a=n("21a6"),s=n("1e78").a,c=(n("7aa2"),n("2877")),r=Object(c.a)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("app-dialog",{directives:[{name:"resize",rawName:"v-resize",value:t.onResize,expression:"onResize"}],attrs:{visible:!0,title:t.$t("logs.logTitle"),width:900}},[n("template",{slot:"dialogContent"},[n("a-spin",{attrs:{spinning:t.loading}},[n("v-virtual-scroll",{directives:[{name:"scroll",rawName:"v-scroll.self",value:t.onScroll,expression:"onScroll",modifiers:{self:!0}}],attrs:{height:t.tableY,items:t.logContent,"item-height":t.itemHeight},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.item;return[n("div",[n("p",{staticClass:"text-no-wrap",staticStyle:{color:"#333"}},[t._v(" "+t._s(o)+" ")])])]}}])})],1)],1),n("template",{slot:"footerLeft"},[n("v-slider",{attrs:{label:t.$t("logs.logItemHeight"),"thumb-label":"",max:"35",min:"18","hide-details":""},model:{value:t.itemHeight,callback:function(e){t.itemHeight=e},expression:"itemHeight"}})],1),n("template",{slot:"dialogBtn"},[t.hasMore?n("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.loadingLog()}}},[t._v(t._s(t.$t("logs.logMore")))]):t._e(),n("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.close()}}},[t._v(t._s(t.$t("homePage.colse")))])],1)],2)}),[],!1,null,"2fd459d0",null).exports,l={name:"LogDeleteDialog",props:{logName:{type:String,default:""}},created:function(){},methods:{close:function(){this.$emit("closeDialog")},action:function(){var t=this;Object(i.a)({logName:this.logName}).then((function(){t.$toast.success(t.$t("homePage.deleteSuccess"))})).catch((function(){})).finally((function(){t.close()}))}}},d=(n("c943"),Object(c.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("app-dialog",{attrs:{visible:!0,title:t.$t("logs.deleteLogTitle"),width:400}},[n("template",{slot:"dialogContent"},[n("div",{staticClass:"dialog-text"},[t._v(" "+t._s(t.$t("logs.deleteLogConfirm",{name:t.logName}))+" ")])]),n("template",{slot:"dialogBtn"},[n("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.action()}}},[t._v(t._s(t.$t("homePage.confirm")))]),n("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.close()}}},[t._v(t._s(t.$t("homePage.colse")))])],1)],2)}),[],!1,null,"7d799708",null).exports),u=n("7ffd"),f={name:"ServerLogs",data:function(){return{tableY:230,logsArr:[],loading:!1,searchCond:void 0,logName:"",children:""}},created:function(){this.doSearch()},methods:{doSearch:function(){var t=this;this.loading=!0,Object(i.c)().then((function(e){t.logsArr=e.logs})).catch((function(){})).finally((function(){t.loading=!1}))},goBack:function(){this.$router.back(-1)},onResize:function(){this.tableY=window.innerHeight-310},viewAction:function(t){this.logName=t,this.children=r},downLoadAction:function(t){var e=this;this.loading=!0,Object(i.b)({logName:t}).then((function(n){Object(a.saveAs)(e.publicMethods.base64ToBlob(n.content,"application/octet-stream"),t)})).catch((function(){})).finally((function(){e.loading=!1}))},filterByFunction:function(t){return!!this.publicMethods.isEmpty(this.searchCond)||-1!==t.date.indexOf(this.searchCond)},closeDialog:function(){this.children="",this.doSearch()},deleteAction:function(t){this.logName=t,this.children=d},isShowDelete:function(t){var e=this.staticVal.RightsCode.DeleteServerLog.code,n=-1!==this.roles.indexOf(e),o=(new Date).todayMoment().diff(t.createMoment(),"days");return n&&o>30}},computed:Object(o.a)({filterData:function(){var t=this;return this.logsArr.filter((function(e){return t.filterByFunction(e)}))}},Object(u.c)("userInfo",["roles"]))},g=(n("0e88"),Object(c.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-card",{staticClass:"card-title"},[n("v-container",{staticClass:"card-container",attrs:{fluid:""}},[n("div",{staticClass:"form-group"},[n("div",{staticClass:"group-item"},[n("v-text-field",{attrs:{label:t.$t("users.searchCond")},model:{value:t.searchCond,callback:function(e){t.searchCond=e},expression:"searchCond"}})],1),n("v-spacer"),n("div",{staticClass:"card-search-btn"},[n("v-btn",{attrs:{rounded:"",dark:""},on:{click:function(e){return t.doSearch()}}},[t._v(" "+t._s(t.$t("homePage.search"))+" ")])],1)],1)])],1),n("a-spin",{attrs:{spinning:t.loading}},[n("div",{directives:[{name:"resize",rawName:"v-resize",value:t.onResize,expression:"onResize"}],staticClass:"logs-box",style:{"max-height":t.tableY+"px"}},[t._l(t.filterData,(function(e,o){return[n("div",{key:o,staticClass:"box",style:(o-1)%3==0?{padding:"0 12px"}:""},[n("v-card",{staticClass:"box-card"},[n("div",{staticClass:"box-item"},[n("v-tooltip",{attrs:{bottom:"","nudge-left":"12"},scopedSlots:t._u([{key:"activator",fn:function(o){var i=o.on;return[n("div",t._g({staticClass:"box-name"},i),[n("b",[t._v(t._s(e.name))])])]}}],null,!0)},[n("div",[t._v(t._s(e.name))])]),n("div",{staticClass:"box-icon"},[n("i",{staticClass:"v-icon material-icons remove_red_eye",on:{click:function(n){return t.viewAction(e.name)}}}),n("div",{staticClass:"icon-text",on:{click:function(n){return t.viewAction(e.name)}}},[t._v(" "+t._s(t.$t("logs.view"))+" ")]),n("i",{staticClass:"v-icon material-icons cloud_download",on:{click:function(n){return t.downLoadAction(e.name)}}}),n("div",{staticClass:"icon-text",on:{click:function(n){return t.downLoadAction(e.name)}}},[t._v(" "+t._s(t.$t("logs.download"))+" ")]),t.isShowDelete(e.date)?n("i",{staticClass:"v-icon material-icons highlight_off",on:{click:function(n){return t.deleteAction(e.name)}}}):t._e(),t.isShowDelete(e.date)?n("div",{staticClass:"icon-text",on:{click:function(n){return t.deleteAction(e.name)}}},[t._v(" "+t._s(t.$t("logs.deleteLog"))+" ")]):t._e(),n("v-spacer"),n("span",{staticClass:"box-size"},[t._v(t._s(e.size))])],1)],1)])],1)]}))],2)]),n("div",{staticClass:"card-bottom card-round-btn"},[n("div",{staticClass:"flex-center"},[n("span",{staticClass:"amount"},[t._v(t._s(t.$t("homePage.tableTotal"))+": "),n("span",{staticClass:"table-total"},[t._v(t._s(t.filterData.length))])])]),n("v-spacer"),n("v-btn",{attrs:{rounded:""},on:{click:function(e){return t.goBack()}}},[t._v(t._s(t.$t("homePage.goback")))])],1),n(t.children,{tag:"component",attrs:{logName:t.logName},on:{closeDialog:t.closeDialog}})],1)}),[],!1,null,"772dc348",null));e.default=g.exports},5124:function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s}));var o=n("b775");function i(t){return o.a.get("/api/logs/server/search",t)}function a(t){return o.a.post("/api/logs/server/download",t)}function s(t){return o.a.post("/api/logs/server/delete",t)}},"7aa2":function(t,e,n){"use strict";n("88b4")},"88b4":function(t,e,n){},"99af":function(t,e,n){"use strict";var o=n("23e7"),i=n("d039"),a=n("e8b5"),s=n("861d"),c=n("7b0b"),r=n("50c4"),l=n("8418"),d=n("65f0"),u=n("1dde"),f=n("b622"),g=n("2d00"),h=f("isConcatSpreadable"),v=g>=51||!i((function(){var t=[];return t[h]=!1,t.concat()[0]!==t})),m=u("concat"),p=function(t){if(!s(t))return!1;var e=t[h];return void 0!==e?!!e:a(t)};o({target:"Array",proto:!0,forced:!v||!m},{concat:function(t){var e,n,o,i,a,s=c(this),u=d(s,0),f=0;for(e=-1,o=arguments.length;e<o;e++)if(a=-1===e?s:arguments[e],p(a)){if(f+(i=r(a.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<i;n++,f++)n in a&&l(u,f,a[n])}else{if(f>=9007199254740991)throw TypeError("Maximum allowed index exceeded");l(u,f++,a)}return u.length=f,u}})},c943:function(t,e,n){"use strict";n("d216")},d00d:function(t,e,n){},d216:function(t,e,n){}}]);