(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4b25fad9"],{"1e78":function(t,e,n){"use strict";(function(t){n("99af"),n("a434"),n("d3b7"),n("ac1f"),n("25f0"),n("1276");var o=n("5124");e.a={name:"LogView",props:{logName:{type:String,default:""}},data:function(){return{loading:!1,hasMore:!1,logContent:[],tableY:230,itemHeight:25,searchCond:void 0,startByte:0,endByte:10240}},created:function(){this.loadingLog()},methods:{loadingLog:function(){var e=this;this.loading=!0,Object(o.b)({logName:this.logName,startByte:this.startByte,endByte:this.endByte}).then((function(n){e.hasMore=n.hasMore;var o=t.from(n.content,"base64").toString().split("\r\n");""===o[o.length-1]?(o.splice(o.length-1,1),e.hasMore||(o[0]=e.logContent.splice(e.logContent.length-1,1)+o[0])):o[0]=e.logContent.splice(e.logContent.length-1,1)+o[0],e.logContent=e.logContent.concat(o),e.hasMore&&(e.startByte=n.startByte,e.endByte=n.endByte)})).catch((function(){})).finally((function(){e.loading=!1}))},close:function(){this.$emit("closeDialog")},onResize:function(){this.tableY=window.innerHeight-246},onScroll:function(t){this.hasMore&&!this.loading&&t.target.scrollTop+t.target.offsetHeight>t.target.scrollHeight-100&&this.loadingLog()}}}}).call(this,n("b639").Buffer)},2262:function(t,e,n){"use strict";n("445c")},"3b6a":function(t,e,n){"use strict";n.r(e),n("4de4"),n("c975"),n("d3b7");var o=n("5124"),i=n("21a6"),a=n("1e78").a,s=(n("6d30"),n("2877")),l=Object(s.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("app-dialog",{directives:[{name:"resize",rawName:"v-resize",value:t.onResize,expression:"onResize"}],attrs:{visible:!0,title:t.$t("logs.logTitle"),width:900}},[n("template",{slot:"dialogContent"},[n("v-text-field",{attrs:{label:t.$t("users.searchCond")},model:{value:t.searchCond,callback:function(e){t.searchCond=e},expression:"searchCond"}}),n("a-spin",{attrs:{spinning:t.loading}},[n("v-virtual-scroll",{directives:[{name:"scroll",rawName:"v-scroll.self",value:t.onScroll,expression:"onScroll",modifiers:{self:!0}}],attrs:{height:t.tableY,items:t.logContent,"item-height":t.itemHeight},scopedSlots:t._u([t.searchCond?{key:"default",fn:function(e){var o=e.item;return[n("div",[n("p",{staticClass:"text-no-wrap",staticStyle:{color:"#333"}},[t._l(o.toString().split(new RegExp("(?<="+t.searchCond+")|(?="+t.searchCond+")","i")),(function(e,o){return[e.toLowerCase()===t.searchCond.toLowerCase()?n("mark",{key:o,staticClass:"highlight"},[t._v(t._s(e))]):[t._v(t._s(e))]]}))],2)])]}}:{key:"default",fn:function(e){var o=e.item;return[n("div",[n("p",{staticClass:"text-no-wrap",staticStyle:{color:"#333"}},[t._v(" "+t._s(o)+" ")])])]}}],null,!0)})],1)],1),n("template",{slot:"footerLeft"},[n("v-slider",{attrs:{label:t.$t("logs.logItemHeight"),"thumb-label":"",max:"35",min:"18","hide-details":""},model:{value:t.itemHeight,callback:function(e){t.itemHeight=e},expression:"itemHeight"}})],1),n("template",{slot:"dialogBtn"},[t.hasMore?n("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.loadingLog()}}},[t._v(t._s(t.$t("logs.logMore")))]):t._e(),n("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.close()}}},[t._v(t._s(t.$t("homePage.colse")))])],1)],2)}),[],!1,null,"39e7bfad",null).exports,c={name:"LogDeleteDialog",props:{logName:{type:String,default:""}},created:function(){},methods:{close:function(){this.$emit("closeDialog")},action:function(){var t=this;Object(o.a)({logName:this.logName}).then((function(){t.$toast.success(t.$t("homePage.deleteSuccess"))})).catch((function(){})).finally((function(){t.close()}))}}},r=(n("c943"),Object(s.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("app-dialog",{attrs:{visible:!0,title:t.$t("logs.deleteLogTitle"),width:400}},[n("template",{slot:"dialogContent"},[n("div",{staticClass:"dialog-text"},[t._v(" "+t._s(t.$t("logs.deleteLogConfirm",{name:t.logName}))+" ")])]),n("template",{slot:"dialogBtn"},[n("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.action()}}},[t._v(t._s(t.$t("homePage.confirm")))]),n("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.close()}}},[t._v(t._s(t.$t("homePage.colse")))])],1)],2)}),[],!1,null,"7d799708",null).exports),d={name:"ServerLogs",data:function(){return{tableY:230,logsArr:[],loading:!1,searchCond:void 0,logName:"",children:""}},created:function(){this.doSearch()},methods:{doSearch:function(){var t=this;this.loading=!0,Object(o.c)().then((function(e){t.logsArr=e.logs})).catch((function(){})).finally((function(){t.loading=!1}))},goBack:function(){this.$router.back(-1)},onResize:function(){this.tableY=window.innerHeight-310},viewAction:function(t){this.logName=t,this.children=l},downLoadAction:function(t){var e=this;this.loading=!0,Object(o.b)({logName:t}).then((function(n){Object(i.saveAs)(e.publicMethods.base64ToBlob(n.content,"application/octet-stream"),t)})).catch((function(){})).finally((function(){e.loading=!1}))},filterByFunction:function(t){return!!this.publicMethods.isEmpty(this.searchCond)||-1!==t.date.indexOf(this.searchCond)},closeDialog:function(){this.children="",this.doSearch()},deleteAction:function(t){this.logName=t,this.children=r},isShowDelete:function(t){var e=this.publicMethods.isPermission("DeleteServerLog"),n=(new Date).todayMoment().diff(t.createMoment(),"days");return e&&n>30}},computed:{filterData:function(){var t=this;return this.logsArr.filter((function(e){return t.filterByFunction(e)}))}}},u=(n("2262"),Object(s.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-card",{staticClass:"card-title"},[n("v-container",{staticClass:"card-container",attrs:{fluid:""}},[n("div",{staticClass:"form-group"},[n("div",{staticClass:"group-item"},[n("v-text-field",{attrs:{clearable:"",label:t.$t("users.searchCond")},model:{value:t.searchCond,callback:function(e){t.searchCond=e},expression:"searchCond"}})],1),n("v-spacer"),n("div",{staticClass:"card-search-btn"},[n("v-btn",{attrs:{rounded:"",dark:""},on:{click:function(e){return t.doSearch()}}},[t._v(" "+t._s(t.$t("homePage.search"))+" ")])],1)],1)])],1),n("a-spin",{attrs:{spinning:t.loading}},[n("div",{directives:[{name:"resize",rawName:"v-resize",value:t.onResize,expression:"onResize"}],staticClass:"logs-box",style:{"max-height":t.tableY+"px"}},[t._l(t.filterData,(function(e,o){return[n("div",{key:o,staticClass:"box",style:(o-1)%3==0?{padding:"0 12px"}:""},[n("v-card",{staticClass:"box-card"},[n("div",{staticClass:"box-item"},[n("v-tooltip",{attrs:{bottom:"","nudge-left":"12"},scopedSlots:t._u([{key:"activator",fn:function(o){var i=o.on;return[n("div",t._g({staticClass:"box-name"},i),[n("b",[t._v(t._s(e.name))])])]}}],null,!0)},[n("div",[t._v(t._s(e.name))])]),n("div",{staticClass:"box-icon"},[n("app-text-icon",{attrs:{small:"",icon:"remove_red_eye",text:t.$t("logs.view")},on:{click:function(n){return t.viewAction(e.name)}}}),n("app-text-icon",{attrs:{small:"",icon:"cloud_download",text:t.$t("logs.download")},on:{click:function(n){return t.downLoadAction(e.name)}}}),t.isShowDelete(e.date)?n("app-text-icon",{attrs:{small:"",icon:"highlight_off",text:t.$t("logs.deleteLog")},on:{click:function(n){return t.deleteAction(e.name)}}}):t._e(),n("v-spacer"),n("span",{staticClass:"box-size"},[t._v(t._s(e.size))])],1)],1)])],1)]}))],2)]),n("div",{staticClass:"card-bottom card-round-btn"},[n("div",{staticClass:"flex-center"},[n("span",{staticClass:"amount"},[t._v(t._s(t.$t("homePage.tableTotal"))+": "),n("span",{staticClass:"table-total"},[t._v(t._s(t.filterData.length))])])]),n("v-spacer"),n("v-btn",{attrs:{rounded:""},on:{click:function(e){return t.goBack()}}},[t._v(t._s(t.$t("homePage.goback")))])],1),n(t.children,{tag:"component",attrs:{logName:t.logName},on:{closeDialog:t.closeDialog}})],1)}),[],!1,null,"89a646de",null));e.default=u.exports},"445c":function(t,e,n){},5124:function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s}));var o=n("b775");function i(t){return o.a.get("/api/logs/server/search",t)}function a(t){return o.a.post("/api/logs/server/download",t)}function s(t){return o.a.post("/api/logs/server/delete",t)}},"5cd2":function(t,e,n){},"6d30":function(t,e,n){"use strict";n("5cd2")},c943:function(t,e,n){"use strict";n("d216")},d216:function(t,e,n){}}]);