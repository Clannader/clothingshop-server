(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-c9c9691c"],{6800:function(t,e,a){"use strict";a.r(e),a("7db0"),a("d3b7");var s=a("5530"),o=a("b775");a("ac1f"),a("1276");var n={name:"UserLogView",props:{userLogObject:{type:Object,default:function(){return{}}}},data:function(){return{logContent:[],tableY:230}},created:function(){this.loadingLog()},methods:{loadingLog:function(){this.logContent=this.userLogObject.content.split("\r\n")},close:function(){this.$emit("closeDialog")},onResize:function(){var t=window.innerHeight-180;25*this.logContent.length>t?this.tableY=t:this.tableY=25*this.logContent.length+13}}},i=(a("adf9"),a("2877")),r=Object(i.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("app-dialog",{directives:[{name:"resize",rawName:"v-resize",value:t.onResize,expression:"onResize"}],attrs:{visible:!0,title:t.$t("logs.userLogTitle"),width:600}},[a("template",{slot:"dialogContent"},[a("v-virtual-scroll",{attrs:{height:t.tableY,items:t.logContent,"item-height":"25"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.item;return[a("div",[a("p",{staticClass:"text-no-wrap",staticStyle:{color:"#333"}},[t._v(" "+t._s(s)+" ")])])]}}])})],1),a("template",{slot:"dialogBtn"},[a("v-btn",{attrs:{depressed:""},on:{click:function(e){return t.close()}}},[t._v(t._s(t.$t("homePage.colse")))])],1)],2)}),[],!1,null,"55589db2",null).exports,c={name:"UserLogs",data:function(){var t={cond:void 0,startDate:void 0,endDate:void 0,type:"ALL"};return{tableData:[],tableY:230,offset:1,pageSize:10,loading:!1,queryParams:t,queryParamsCopy:t,tableTotal:0,children:"",isSelect:{}}},created:function(){this.doSearch()},methods:{doSearch:function(){var t,e=this;this.loading=!0,this.publicMethods.compareObjects(this.queryParamsCopy,this.queryParams)||(this.offset=1),(t=Object(s.a)(Object(s.a)({},this.queryParams),{},{offset:this.offset,pageSize:this.pageSize}),o.a.get("/api/logs/user/search",{params:t})).then((function(t){e.tableData=t.logs,e.tableTotal=t.total})).catch((function(){e.tableData=[],e.tableTotal=0})).finally((function(){e.loading=!1,e.tableData.find((function(t){return e.isSelect._id===t._id}))||(e.isSelect={}),e.queryParamsCopy=Object.assign({},e.queryParams)}))},initDoSearh:function(){},goBack:function(){this.$router.back(-1)},onResize:function(){this.tableY=window.innerHeight-427-70},rowClass:function(t){if(t._id===this.isSelect._id)return"rowSelected"},rowClick:function(t){var e=this;return{on:{click:function(){e.selectedRow(t)},dblclick:function(){e.viewLogs(t)}}}},selectedRow:function(t){this.isSelect=t},viewLogs:function(){this.children=r},closeDialog:function(){this.children="",this.doSearch()}},computed:{tableColumns:{get:function(){return[{title:"".concat(this.$t("users.shopId")),width:100,dataIndex:"shopId"},{title:"".concat(this.$t("users.adminName")),width:150,dataIndex:"userName"},{title:"".concat(this.$t("logs.contents")),ellipsis:!0,dataIndex:"content"},{title:"".concat(this.$t("logs.date")),dataIndex:"date",width:180,scopedSlots:{customRender:"logDate"}},{title:"".concat(this.$t("logs.logType")),dataIndex:"type",width:120},{title:"".concat(this.$t("logs.requestIP")),dataIndex:"requestIP",width:120},{title:"".concat(this.$t("homePage.operation")),dataIndex:"",key:"action",fixed:"right",scopedSlots:{customRender:"action"},width:60,align:"center"}]}},logTypeItem:{get:function(){return[{code:"ALL",desc:"".concat(this.$t("logs.allType"))},{code:"ServerLog",desc:"".concat(this.$t("logs.serverType"))},{code:"Right",desc:"".concat(this.$t("logs.rightType"))},{code:"User",desc:"".concat(this.$t("logs.userType"))}]}}}},l=(a("82b7"),Object(i.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",{staticClass:"card-title"},[a("v-container",{staticClass:"card-container",attrs:{fluid:""}},[a("div",{staticClass:"form-group"},[a("div",{staticClass:"group-item"},[a("app-date-picker",{attrs:{label:t.$t("logs.startDate"),max:t.queryParams.endDate,"update-value":t.queryParams.startDate,"close-on-content-click":!1,readonly:"",clearable:""},on:{"update:updateValue":function(e){return t.$set(t.queryParams,"startDate",e)},"update:update-value":function(e){return t.$set(t.queryParams,"startDate",e)}}})],1),a("div",{staticClass:"group-item"},[a("app-date-picker",{attrs:{label:t.$t("logs.endDate"),min:t.queryParams.startDate,"update-value":t.queryParams.endDate,"close-on-content-click":!1,readonly:"",clearable:""},on:{"update:updateValue":function(e){return t.$set(t.queryParams,"endDate",e)},"update:update-value":function(e){return t.$set(t.queryParams,"endDate",e)}}})],1),a("div",{staticClass:"group-item"},[a("v-select",{attrs:{items:t.logTypeItem,"item-value":"code","item-text":"desc",label:t.$t("logs.logType")},on:{change:t.doSearch},scopedSlots:t._u([{key:"item",fn:function(e){var s=e.item,o=e.attrs,n=e.on;return[a("v-list-item",t._g(t._b({},"v-list-item",o,!1),n),[a("v-list-item-title",{domProps:{textContent:t._s(s.desc+" ("+s.code+")")}})],1)]}}]),model:{value:t.queryParams.type,callback:function(e){t.$set(t.queryParams,"type",e)},expression:"queryParams.type"}})],1),a("div",{staticClass:"group-item"},[a("v-text-field",{attrs:{label:t.$t("users.searchCond")},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSearch(e)}},model:{value:t.queryParams.cond,callback:function(e){t.$set(t.queryParams,"cond",e)},expression:"queryParams.cond"}})],1)]),a("div",{staticClass:"form-group"},[a("div",{staticClass:"group-item"},[a("v-text-field",{attrs:{label:t.$t("logs.queryShop")},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSearch(e)}},model:{value:t.queryParams.shopId,callback:function(e){t.$set(t.queryParams,"shopId",e)},expression:"queryParams.shopId"}})],1),a("div",{staticClass:"group-item"},[a("v-text-field",{attrs:{label:t.$t("logs.queryUserID")},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSearch(e)}},model:{value:t.queryParams.adminId,callback:function(e){t.$set(t.queryParams,"adminId",e)},expression:"queryParams.adminId"}})],1),a("v-spacer"),a("div",{staticClass:"card-search-btn"},[a("v-btn",{attrs:{rounded:"",dark:""},on:{click:function(e){return t.doSearch()}}},[t._v(" "+t._s(t.$t("homePage.search"))+" ")])],1)],1)])],1),a("v-card",{directives:[{name:"resize",rawName:"v-resize",value:t.onResize,expression:"onResize"}],staticClass:"card-body"},[a("app-table",{attrs:{columns:t.tableColumns,dataSource:t.tableData,rowKey:function(t){return t._id},loading:t.loading,total:t.tableTotal,scroll:{x:1e3,y:t.tableY},rowClassName:t.rowClass,customRow:t.rowClick,offset:t.offset,pageSize:t.pageSize},on:{change:t.doSearch,"update:offset":function(e){t.offset=e},"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e}},scopedSlots:t._u([{key:"logDate",fn:function(e){var s=e.record;return[a("div",{staticClass:"text-ellipsis"},[t._v(" "+t._s(s.format("YYYY-MM-DD HH:mm:ss"))+" ")])]}},{key:"action",fn:function(e){var s=e.record;return[a("v-menu",{attrs:{bottom:"",left:"",transition:"slide-y-transition"},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[a("v-btn",t._g({attrs:{icon:"",small:""},on:{click:function(e){return t.selectedRow(s)}}},o),[a("v-icon",{staticStyle:{color:"#0055b8"}},[t._v(" more_vert ")])],1)]}}],null,!0)},[a("v-list",{staticClass:"option-menu-list"},[a("v-list-item",{on:{click:function(e){return t.viewLogs(s)}}},[a("i",{staticClass:"material-icons remove_red_eye"}),a("v-list-item-title",[t._v(" "+t._s(t.$t("logs.view"))+" ")])],1)],1)],1)]}}])})],1),a("div",{staticClass:"card-bottom card-round-btn"},[a("v-btn",{attrs:{rounded:""},on:{click:function(e){return t.goBack()}}},[t._v(t._s(t.$t("homePage.goback")))])],1),a(t.children,{tag:"component",attrs:{userLogObject:t.isSelect},on:{closeDialog:t.closeDialog}})],1)}),[],!1,null,"031e0b67",null));e.default=l.exports},"82b7":function(t,e,a){"use strict";a("ea38")},adf9:function(t,e,a){"use strict";a("d035")},d035:function(t,e,a){},ea38:function(t,e,a){}}]);